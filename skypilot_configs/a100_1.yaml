name: a100_one

resources:
  accelerators: A100:1 # 2, 4, 8
  ports: 8080-8100
  cloud: gcp
  use_spot: True
  region: us-central1
  disk_size: 500

workdir: .

file_mounts:
  /data:
    source: ${BUCKET}
    mode: MOUNT
    
setup: |
  echo $HF_TOKEN
  pip install .
  pip install wandb
  echo "installation DONE"
  wandb login --relogin $WANDB_API_KEY
  huggingface-cli login --token $HF_TOKEN
  echo "SETUP DONE"

run: |
  ACCELERATE_LOG_LEVEL=info  accelerate launch --config_file accelerate_configs/single_gpu.yaml scripts/run_cpt.py recipes/cpt_yevhen/cpt_gemma3.yaml 
  echo "RUN DONE"


envs:
  BUCKET: gs://gpu-research-cloud-1